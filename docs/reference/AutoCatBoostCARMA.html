<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>AutoCatBoostCARMA — AutoCatBoostCARMA • RemixAutoML</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="AutoCatBoostCARMA — AutoCatBoostCARMA" />
<meta property="og:description" content="AutoCatBoostCARMA Mutlivariate Forecasting with calendar variables, Holiday counts, holiday lags, holiday moving averages, differencing, transformations, interaction-based categorical encoding using target variable and features to generate various time-based aggregated lags, moving averages, moving standard deviations, moving skewness, moving kurtosis, moving quantiles, parallelized interaction-based fourier pairs by grouping variables, and Trend Variables." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9FSKBWGTJ3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9FSKBWGTJ3');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RemixAutoML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AdrianAntico/RemixAutoML/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>AutoCatBoostCARMA</h1>
    <small class="dont-index">Source: <a href='https://github.com/AdrianAntico/RemixAutoML/blob/master/R/AutoCatBoostCARMA.R'><code>R/AutoCatBoostCARMA.R</code></a></small>
    <div class="hidden name"><code>AutoCatBoostCARMA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>AutoCatBoostCARMA Mutlivariate Forecasting with calendar variables, Holiday counts, holiday lags, holiday moving averages, differencing, transformations, interaction-based categorical encoding using target variable and features to generate various time-based aggregated lags, moving averages, moving standard deviations, moving skewness, moving kurtosis, moving quantiles, parallelized interaction-based fourier pairs by grouping variables, and Trend Variables.</p>
    </div>

    <pre class="usage"><span class='fu'>AutoCatBoostCARMA</span><span class='op'>(</span>
  <span class='va'>data</span>,
  TimeWeights <span class='op'>=</span> <span class='cn'>NULL</span>,
  NonNegativePred <span class='op'>=</span> <span class='cn'>FALSE</span>,
  RoundPreds <span class='op'>=</span> <span class='cn'>FALSE</span>,
  TrainOnFull <span class='op'>=</span> <span class='cn'>FALSE</span>,
  TargetColumnName <span class='op'>=</span> <span class='st'>"Target"</span>,
  DateColumnName <span class='op'>=</span> <span class='st'>"DateTime"</span>,
  HierarchGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
  GroupVariables <span class='op'>=</span> <span class='cn'>NULL</span>,
  FC_Periods <span class='op'>=</span> <span class='fl'>30</span>,
  TimeUnit <span class='op'>=</span> <span class='st'>"week"</span>,
  TimeGroups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"weeks"</span>, <span class='st'>"months"</span><span class='op'>)</span>,
  PDFOutputPath <span class='op'>=</span> <span class='cn'>NULL</span>,
  SaveDataPath <span class='op'>=</span> <span class='cn'>NULL</span>,
  NumOfParDepPlots <span class='op'>=</span> <span class='fl'>10L</span>,
  TargetTransformation <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Methods <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BoxCox"</span>, <span class='st'>"Asinh"</span>, <span class='st'>"Log"</span>, <span class='st'>"LogPlus1"</span>, <span class='st'>"Sqrt"</span>, <span class='st'>"Asin"</span>, <span class='st'>"Logit"</span><span class='op'>)</span>,
  AnomalyDetection <span class='op'>=</span> <span class='cn'>NULL</span>,
  XREGS <span class='op'>=</span> <span class='cn'>NULL</span>,
  Lags <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span><span class='op'>:</span><span class='fl'>5L</span><span class='op'>)</span>,
  MA_Periods <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2L</span><span class='op'>:</span><span class='fl'>5L</span><span class='op'>)</span>,
  SD_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
  Skew_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
  Kurt_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
  Quantile_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
  Quantiles_Selected <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"q5"</span>, <span class='st'>"q95"</span><span class='op'>)</span>,
  Difference <span class='op'>=</span> <span class='cn'>TRUE</span>,
  FourierTerms <span class='op'>=</span> <span class='fl'>6L</span>,
  CalendarVariables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"minute"</span>, <span class='st'>"hour"</span>, <span class='st'>"wday"</span>, <span class='st'>"mday"</span>, <span class='st'>"yday"</span>, <span class='st'>"week"</span>, <span class='st'>"isoweek"</span>,
    <span class='st'>"month"</span>, <span class='st'>"quarter"</span>, <span class='st'>"year"</span><span class='op'>)</span>,
  HolidayVariable <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"USPublicHolidays"</span>, <span class='st'>"EasterGroup"</span>, <span class='st'>"ChristmasGroup"</span>,
    <span class='st'>"OtherEcclesticalFeasts"</span><span class='op'>)</span>,
  HolidayLookback <span class='op'>=</span> <span class='cn'>NULL</span>,
  HolidayLags <span class='op'>=</span> <span class='fl'>1L</span>,
  HolidayMovingAverages <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>:</span><span class='fl'>2L</span>,
  TimeTrendVariable <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ZeroPadSeries <span class='op'>=</span> <span class='cn'>NULL</span>,
  DataTruncate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  SplitRatios <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.7</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span><span class='op'>)</span>,
  PartitionType <span class='op'>=</span> <span class='st'>"timeseries"</span>,
  TaskType <span class='op'>=</span> <span class='st'>"GPU"</span>,
  NumGPU <span class='op'>=</span> <span class='fl'>1</span>,
  DebugMode <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Timer <span class='op'>=</span> <span class='cn'>TRUE</span>,
  EvalMetric <span class='op'>=</span> <span class='st'>"RMSE"</span>,
  EvalMetricValue <span class='op'>=</span> <span class='fl'>1.5</span>,
  LossFunction <span class='op'>=</span> <span class='st'>"RMSE"</span>,
  LossFunctionValue <span class='op'>=</span> <span class='fl'>1.5</span>,
  GridTune <span class='op'>=</span> <span class='cn'>FALSE</span>,
  PassInGrid <span class='op'>=</span> <span class='cn'>NULL</span>,
  ModelCount <span class='op'>=</span> <span class='fl'>100</span>,
  MaxRunsWithoutNewWinner <span class='op'>=</span> <span class='fl'>50</span>,
  MaxRunMinutes <span class='op'>=</span> <span class='fl'>24L</span> <span class='op'>*</span> <span class='fl'>60L</span>,
  Langevin <span class='op'>=</span> <span class='cn'>FALSE</span>,
  DiffusionTemperature <span class='op'>=</span> <span class='fl'>10000</span>,
  NTrees <span class='op'>=</span> <span class='fl'>1000</span>,
  L2_Leaf_Reg <span class='op'>=</span> <span class='cn'>NULL</span>,
  LearningRate <span class='op'>=</span> <span class='cn'>NULL</span>,
  RandomStrength <span class='op'>=</span> <span class='fl'>1</span>,
  BorderCount <span class='op'>=</span> <span class='fl'>254</span>,
  Depth <span class='op'>=</span> <span class='fl'>6</span>,
  RSM <span class='op'>=</span> <span class='fl'>1</span>,
  BootStrapType <span class='op'>=</span> <span class='st'>"Bayesian"</span>,
  GrowPolicy <span class='op'>=</span> <span class='st'>"SymmetricTree"</span>,
  ModelSizeReg <span class='op'>=</span> <span class='fl'>0.5</span>,
  FeatureBorderType <span class='op'>=</span> <span class='st'>"GreedyLogSum"</span>,
  SamplingUnit <span class='op'>=</span> <span class='st'>"Group"</span>,
  SubSample <span class='op'>=</span> <span class='cn'>NULL</span>,
  ScoreFunction <span class='op'>=</span> <span class='st'>"Cosine"</span>,
  MinDataInLeaf <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Supply your full series data set here</p></td>
    </tr>
    <tr>
      <th>TimeWeights</th>
      <td><p>Supply a value that will be multiplied by he time trend value</p></td>
    </tr>
    <tr>
      <th>NonNegativePred</th>
      <td><p>TRUE or FALSE</p></td>
    </tr>
    <tr>
      <th>RoundPreds</th>
      <td><p>Rounding predictions to an integer value. TRUE or FALSE. Defaults to FALSE</p></td>
    </tr>
    <tr>
      <th>TrainOnFull</th>
      <td><p>Set to TRUE to train on full data</p></td>
    </tr>
    <tr>
      <th>TargetColumnName</th>
      <td><p>List the column name of your target variables column. E.g. 'Target'</p></td>
    </tr>
    <tr>
      <th>DateColumnName</th>
      <td><p>List the column name of your date column. E.g. 'DateTime'</p></td>
    </tr>
    <tr>
      <th>HierarchGroups</th>
      <td><p>Vector of hierachy categorical columns.</p></td>
    </tr>
    <tr>
      <th>GroupVariables</th>
      <td><p>Defaults to NULL. Use NULL when you have a single series. Add in GroupVariables when you have a series for every level of a group or multiple groups.</p></td>
    </tr>
    <tr>
      <th>FC_Periods</th>
      <td><p>Set the number of periods you want to have forecasts for. E.g. 52 for weekly data to forecast a year ahead</p></td>
    </tr>
    <tr>
      <th>TimeUnit</th>
      <td><p>List the time unit your data is aggregated by. E.g. '1min', '5min', '10min', '15min', '30min', 'hour', 'day', 'week', 'month', 'quarter', 'year'.</p></td>
    </tr>
    <tr>
      <th>TimeGroups</th>
      <td><p>Select time aggregations for adding various time aggregated GDL features.</p></td>
    </tr>
    <tr>
      <th>PDFOutputPath</th>
      <td><p>NULL or a path file to output PDFs to a specified folder</p></td>
    </tr>
    <tr>
      <th>SaveDataPath</th>
      <td><p>NULL Or supply a path. Data saved will be called 'ModelID'_data.csv</p></td>
    </tr>
    <tr>
      <th>NumOfParDepPlots</th>
      <td><p>Supply a number for the number of partial dependence plots you want returned</p></td>
    </tr>
    <tr>
      <th>TargetTransformation</th>
      <td><p>TRUE or FALSE. If TRUE, select the methods in the Methods arg you want tested. The best one will be applied.</p></td>
    </tr>
    <tr>
      <th>Methods</th>
      <td><p>Choose from 'YeoJohnson', 'BoxCox', 'Asinh', 'Log', 'LogPlus1', 'Sqrt', 'Asin', or 'Logit'. If more than one is selected, the one with the best normalization pearson statistic will be used. Identity is automatically selected and compared.</p></td>
    </tr>
    <tr>
      <th>AnomalyDetection</th>
      <td><p>NULL for not using the service. Other, provide a list, e.g. AnomalyDetection = list('tstat_high' = 4, 'tstat_low' = -4)</p></td>
    </tr>
    <tr>
      <th>XREGS</th>
      <td><p>Additional data to use for model development and forecasting. Data needs to be a complete series which means both the historical and forward looking values over the specified forecast window needs to be supplied.</p></td>
    </tr>
    <tr>
      <th>Lags</th>
      <td><p>Select the periods for all lag variables you want to create. E.g. c(1:5,52) or list('day' = c(1:10), 'weeks' = c(1:4))</p></td>
    </tr>
    <tr>
      <th>MA_Periods</th>
      <td><p>Select the periods for all moving average variables you want to create. E.g. c(1:5,52) or list('day' = c(2:10), 'weeks' = c(2:4))</p></td>
    </tr>
    <tr>
      <th>SD_Periods</th>
      <td><p>Select the periods for all moving standard deviation variables you want to create. E.g. c(1:5,52) or list('day' = c(2:10), 'weeks' = c(2:4))</p></td>
    </tr>
    <tr>
      <th>Skew_Periods</th>
      <td><p>Select the periods for all moving skewness variables you want to create. E.g. c(1:5,52) or list('day' = c(2:10), 'weeks' = c(2:4))</p></td>
    </tr>
    <tr>
      <th>Kurt_Periods</th>
      <td><p>Select the periods for all moving kurtosis variables you want to create. E.g. c(1:5,52) or list('day' = c(2:10), 'weeks' = c(2:4))</p></td>
    </tr>
    <tr>
      <th>Quantile_Periods</th>
      <td><p>Select the periods for all moving quantiles variables you want to create. E.g. c(1:5,52) or list('day' = c(2:10), 'weeks' = c(2:4))</p></td>
    </tr>
    <tr>
      <th>Quantiles_Selected</th>
      <td><p>Select from the following 'q5', 'q10', 'q15', 'q20', 'q25', 'q30', 'q35', 'q40', 'q45', 'q50', 'q55', 'q60', 'q65', 'q70', 'q75', 'q80', 'q85', 'q90', 'q95'</p></td>
    </tr>
    <tr>
      <th>Difference</th>
      <td><p>Puts the I in ARIMA for single series and grouped series.</p></td>
    </tr>
    <tr>
      <th>FourierTerms</th>
      <td><p>Set to the max number of pairs. E.g. 2 means to generate two pairs for by each group level and interations if hierarchy is enabled.</p></td>
    </tr>
    <tr>
      <th>CalendarVariables</th>
      <td><p>NULL, or select from 'minute', 'hour', 'wday', 'mday', 'yday', 'week', 'isoweek', 'month', 'quarter', 'year'</p></td>
    </tr>
    <tr>
      <th>HolidayVariable</th>
      <td><p>NULL, or select from 'USPublicHolidays', 'EasterGroup', 'ChristmasGroup', 'OtherEcclesticalFeasts'</p></td>
    </tr>
    <tr>
      <th>HolidayLookback</th>
      <td><p>Number of days in range to compute number of holidays from a given date in the data. If NULL, the number of days are computed for you.</p></td>
    </tr>
    <tr>
      <th>HolidayLags</th>
      <td><p>Number of lags to build off of the holiday count variable.</p></td>
    </tr>
    <tr>
      <th>HolidayMovingAverages</th>
      <td><p>Number of moving averages to build off of the holiday count variable.</p></td>
    </tr>
    <tr>
      <th>TimeTrendVariable</th>
      <td><p>Set to TRUE to have a time trend variable added to the model. Time trend is numeric variable indicating the numeric value of each record in the time series (by group). Time trend starts at 1 for the earliest point in time and increments by one for each success time point.</p></td>
    </tr>
    <tr>
      <th>ZeroPadSeries</th>
      <td><p>NULL to do nothing. Otherwise, set to 'maxmax', 'minmax', 'maxmin', 'minmin'. See <code><a href='TimeSeriesFill.html'>TimeSeriesFill</a></code> for explanations of each type</p></td>
    </tr>
    <tr>
      <th>DataTruncate</th>
      <td><p>Set to TRUE to remove records with missing values from the lags and moving average features created</p></td>
    </tr>
    <tr>
      <th>SplitRatios</th>
      <td><p>E.g c(0.7,0.2,0.1) for train, validation, and test sets</p></td>
    </tr>
    <tr>
      <th>PartitionType</th>
      <td><p>Select 'random' for random data partitioning 'timeseries' for partitioning by time frames</p></td>
    </tr>
    <tr>
      <th>TaskType</th>
      <td><p>Default is 'GPU' but you can also set it to 'CPU'</p></td>
    </tr>
    <tr>
      <th>NumGPU</th>
      <td><p>Defaults to 1. If CPU is set this argument will be ignored.</p></td>
    </tr>
    <tr>
      <th>DebugMode</th>
      <td><p>Defaults to FALSE. Set to TRUE to get a print statement of each high level comment in function</p></td>
    </tr>
    <tr>
      <th>Timer</th>
      <td><p>Set to FALSE to turn off the updating print statements for progress</p></td>
    </tr>
    <tr>
      <th>EvalMetric</th>
      <td><p>Select from 'RMSE', 'MAE', 'MAPE', 'Poisson', 'Quantile', 'LogLinQuantile', 'Lq', 'NumErrors', 'SMAPE', 'R2', 'MSLE', 'MedianAbsoluteError'</p></td>
    </tr>
    <tr>
      <th>EvalMetricValue</th>
      <td><p>Used when EvalMetric accepts an argument. See <code><a href='AutoCatBoostRegression.html'>AutoCatBoostRegression</a></code></p></td>
    </tr>
    <tr>
      <th>LossFunction</th>
      <td><p>Used in model training for model fitting. Select from 'RMSE', 'MAE', 'Quantile', 'LogLinQuantile', 'MAPE', 'Poisson', 'PairLogitPairwise', 'Tweedie', 'QueryRMSE'</p></td>
    </tr>
    <tr>
      <th>LossFunctionValue</th>
      <td><p>Used when LossFunction accepts an argument. See <code><a href='AutoCatBoostRegression.html'>AutoCatBoostRegression</a></code></p></td>
    </tr>
    <tr>
      <th>GridTune</th>
      <td><p>Set to TRUE to run a grid tune</p></td>
    </tr>
    <tr>
      <th>PassInGrid</th>
      <td><p>Defaults to NULL</p></td>
    </tr>
    <tr>
      <th>ModelCount</th>
      <td><p>Set the number of models to try in the grid tune</p></td>
    </tr>
    <tr>
      <th>MaxRunsWithoutNewWinner</th>
      <td><p>Default is 50</p></td>
    </tr>
    <tr>
      <th>MaxRunMinutes</th>
      <td><p>Default is 60*60</p></td>
    </tr>
    <tr>
      <th>Langevin</th>
      <td><p>Enables the Stochastic Gradient Langevin Boosting mode. If TRUE and TaskType == 'GPU' then TaskType will be converted to 'CPU'</p></td>
    </tr>
    <tr>
      <th>DiffusionTemperature</th>
      <td><p>Default is 10000</p></td>
    </tr>
    <tr>
      <th>NTrees</th>
      <td><p>Select the number of trees you want to have built to train the model</p></td>
    </tr>
    <tr>
      <th>L2_Leaf_Reg</th>
      <td><p>l2 reg parameter</p></td>
    </tr>
    <tr>
      <th>LearningRate</th>
      <td><p>Defaults to NULL. Catboost will dynamically define this if L2_Leaf_Reg is NULL and RMSE is chosen (otherwise catboost will default it to 0.03). Then you can pull it out of the model object and pass it back in should you wish.</p></td>
    </tr>
    <tr>
      <th>RandomStrength</th>
      <td><p>Default is 1</p></td>
    </tr>
    <tr>
      <th>BorderCount</th>
      <td><p>Default is 254</p></td>
    </tr>
    <tr>
      <th>Depth</th>
      <td><p>Depth of catboost model</p></td>
    </tr>
    <tr>
      <th>RSM</th>
      <td><p>CPU only. If TaskType is GPU then RSM will not be used</p></td>
    </tr>
    <tr>
      <th>BootStrapType</th>
      <td><p>If NULL, then if TaskType is GPU then Bayesian will be used. If CPU then MVS will be used. If MVS is selected when TaskType is GPU, then BootStrapType will be switched to Bayesian</p></td>
    </tr>
    <tr>
      <th>GrowPolicy</th>
      <td><p>Default is SymmetricTree. Others include Lossguide and Depthwise</p></td>
    </tr>
    <tr>
      <th>ModelSizeReg</th>
      <td><p>Defaults to 0.5. Set to 0 to allow for bigger models. This is for models with high cardinality categorical features. Valuues greater than 0 will shrink the model and quality will decline but models won't be huge.</p></td>
    </tr>
    <tr>
      <th>FeatureBorderType</th>
      <td><p>Defaults to 'GreedyLogSum'. Other options include: Median, Uniform, UniformAndQuantiles, MaxLogSum, MinEntropy</p></td>
    </tr>
    <tr>
      <th>SamplingUnit</th>
      <td><p>Default is Group. Other option is Object. if GPU is selected, this will be turned off unless the loss_function is YetiRankPairWise</p></td>
    </tr>
    <tr>
      <th>SubSample</th>
      <td><p>Can use if BootStrapType is neither Bayesian nor No. Pass NULL to use Catboost default. Used for bagging.</p></td>
    </tr>
    <tr>
      <th>ScoreFunction</th>
      <td><p>Default is Cosine. CPU options are Cosine and L2. GPU options are Cosine, L2, NewtonL2, and NewtomCosine (not available for Lossguide)</p></td>
    </tr>
    <tr>
      <th>MinDataInLeaf</th>
      <td><p>Defaults to 1. Used if GrowPolicy is not SymmetricTree</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>See examples</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Automated Panel Data Forecasting: 
<code><a href='AutoCatBoostHurdleCARMA.html'>AutoCatBoostHurdleCARMA</a>()</code>,
<code><a href='AutoCatBoostVectorCARMA.html'>AutoCatBoostVectorCARMA</a>()</code>,
<code><a href='AutoH2OCARMA.html'>AutoH2OCARMA</a>()</code>,
<code><a href='AutoLightGBMCARMA.html'>AutoLightGBMCARMA</a>()</code>,
<code><a href='AutoLightGBMHurdleCARMA.html'>AutoLightGBMHurdleCARMA</a>()</code>,
<code><a href='AutoXGBoostCARMA.html'>AutoXGBoostCARMA</a>()</code>,
<code><a href='AutoXGBoostHurdleCARMA.html'>AutoXGBoostHurdleCARMA</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Adrian Antico</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># Set up your output file path for saving results as a .csv</span>
<span class='va'>Path</span> <span class='op'>&lt;-</span> <span class='st'>'C:/YourPathHere'</span>

<span class='co'># Run on GPU or CPU (some options in the grid tuning force usage of CPU for some runs)</span>
<span class='va'>TaskType</span> <span class='op'>=</span> <span class='st'>'GPU'</span>

<span class='co'># Define number of CPU threads to allow data.table to utilize</span>
<span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html'>setDTthreads</a></span><span class='op'>(</span>percent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>2L</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Load data</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></span><span class='op'>(</span><span class='st'>'https://www.dropbox.com/s/2str3ek4f4cheqi/walmart_train.csv?dl=1'</span><span class='op'>)</span>

<span class='co'># Ensure series have no missing dates (also remove series with more than 25% missing values)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>RemixAutoML</span><span class='fu'>::</span><span class='fu'><a href='TimeSeriesFill.html'>TimeSeriesFill</a></span><span class='op'>(</span>
  <span class='va'>data</span>,
  DateColumnName <span class='op'>=</span> <span class='st'>'Date'</span>,
  GroupVariables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span>,
  TimeUnit <span class='op'>=</span> <span class='st'>'weeks'</span>,
  FillType <span class='op'>=</span> <span class='st'>'maxmax'</span>,
  MaxMissingPercent <span class='op'>=</span> <span class='fl'>0.25</span>,
  SimpleImpute <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Set negative numbers to 0</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[</span>, <span class='va'>Weekly_Sales</span> <span class='op'>:=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fifelse.html'>fifelse</a></span><span class='op'>(</span><span class='va'>Weekly_Sales</span> <span class='op'>&lt;</span> <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='va'>Weekly_Sales</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Remove IsHoliday column</span>
<span class='va'>data</span><span class='op'>[</span>, <span class='va'>IsHoliday</span> <span class='op'>:=</span> <span class='cn'>NULL</span><span class='op'>]</span>

<span class='co'># Create xregs (this is the include the categorical variables instead of utilizing only the interaction of them)</span>
<span class='va'>xregs</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[</span>, <span class='va'>.SD</span>, .SDcols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>, <span class='st'>'Store'</span>, <span class='st'>'Dept'</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Change data types</span>
<span class='va'>data</span><span class='op'>[</span>, <span class='st'>':='</span> <span class='op'>(</span>Store <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Store</span><span class='op'>)</span>, Dept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Dept</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>xregs</span><span class='op'>[</span>, <span class='st'>':='</span> <span class='op'>(</span>Store <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Store</span><span class='op'>)</span>, Dept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Dept</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Subset data so we have an out of time sample</span>
<span class='va'>data1</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/copy.html'>copy</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>[</span>, <span class='va'>ID</span> <span class='op'>:=</span> <span class='fl'>1L</span><span class='op'>:</span><span class='va'>.N</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span><span class='va'>ID</span> <span class='op'>&lt;=</span> <span class='fl'>125L</span><span class='op'>]</span><span class='op'>[</span>, <span class='va'>ID</span> <span class='op'>:=</span> <span class='cn'>NULL</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>[</span>, <span class='va'>ID</span> <span class='op'>:=</span> <span class='cn'>NULL</span><span class='op'>]</span>

<span class='co'># Define values for SplitRatios and FCWindow Args</span>
<span class='va'>N1</span> <span class='op'>&lt;-</span> <span class='va'>data1</span><span class='op'>[</span>, <span class='va'>.N</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span><span class='fl'>1L</span>, <span class='va'>N</span><span class='op'>]</span>
<span class='va'>N2</span> <span class='op'>&lt;-</span> <span class='va'>xregs</span><span class='op'>[</span>, <span class='va'>.N</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span><span class='fl'>1L</span>, <span class='va'>N</span><span class='op'>]</span>

<span class='co'># Setup Grid Tuning &amp; Feature Tuning data.table using a cross join of vectors</span>
<span class='va'>Tuning</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/J.html'>CJ</a></span><span class='op'>(</span>
  TimeWeights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'None'</span>,<span class='fl'>0.999</span><span class='op'>)</span>,
  MaxTimeGroups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'weeks'</span>,<span class='st'>'months'</span><span class='op'>)</span>,
  TargetTransformation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'TRUE'</span>,<span class='st'>'FALSE'</span><span class='op'>)</span>,
  Difference <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'TRUE'</span>,<span class='st'>'FALSE'</span><span class='op'>)</span>,
  HoldoutTrain <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>18</span><span class='op'>)</span>,
  Langevin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'TRUE'</span>,<span class='st'>'FALSE'</span><span class='op'>)</span>,
  NTrees <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2500</span>,<span class='fl'>5000</span><span class='op'>)</span>,
  Depth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>,<span class='fl'>9</span><span class='op'>)</span>,
  RandomStrength <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.75</span>,<span class='fl'>1</span><span class='op'>)</span>,
  L2_Leaf_Reg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3.0</span>,<span class='fl'>4.0</span><span class='op'>)</span>,
  RSM <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.75</span>,<span class='st'>'NULL'</span><span class='op'>)</span>,
  GrowPolicy <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'SymmetricTree'</span>,<span class='st'>'Lossguide'</span>,<span class='st'>'Depthwise'</span><span class='op'>)</span>,
  BootStrapType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Bayesian'</span>,<span class='st'>'MVS'</span>,<span class='st'>'No'</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Remove options that are not compatible with GPU (skip over this otherwise)</span>
<span class='va'>Tuning</span> <span class='op'>&lt;-</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Langevin</span> <span class='op'>==</span> <span class='st'>'TRUE'</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>Langevin</span> <span class='op'>==</span> <span class='st'>'FALSE'</span> <span class='op'>&amp;</span> <span class='va'>RSM</span> <span class='op'>==</span> <span class='st'>'NULL'</span> <span class='op'>&amp;</span> <span class='va'>BootStrapType</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Bayesian'</span>,<span class='st'>'No'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Randomize order of Tuning data.table</span>
<span class='va'>Tuning</span> <span class='op'>&lt;-</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>.N</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Load grid results and remove rows that have already been tested</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>Path</span>, <span class='st'>'Walmart_CARMA_Metrics.csv'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>Metrics</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fread.html'>fread</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>Path</span>, <span class='st'>'Walmart_CARMA_Metrics.csv'</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html'>rbindlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>Metrics</span>,<span class='va'>Tuning</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>temp</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>temp</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>Tuning</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>RunTime</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span>, <span class='va'>.SD</span>, .SDcols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>)</span><span class='op'>]</span>
  <span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>Metrics</span>,<span class='va'>temp</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Define the total number of runs</span>
<span class='va'>TotalRuns</span> <span class='op'>&lt;-</span> <span class='va'>Tuning</span><span class='op'>[</span>,<span class='va'>.N</span><span class='op'>]</span>

<span class='co'># Kick off feature + grid tuning</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>Run</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>TotalRuns</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>

  <span class='co'># Print run number</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>zz</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>Run</span><span class='op'>)</span>

  <span class='co'># Use fresh data for each run</span>
  <span class='va'>xregs_new</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/copy.html'>copy</a></span><span class='op'>(</span><span class='va'>xregs</span><span class='op'>)</span>
  <span class='va'>data_new</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/copy.html'>copy</a></span><span class='op'>(</span><span class='va'>data1</span><span class='op'>)</span>

  <span class='co'># Timer start</span>
  <span class='va'>StartTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='co'># Run carma system</span>
  <span class='va'>CatBoostResults</span> <span class='op'>&lt;-</span> <span class='fu'>RemixAutoML</span><span class='fu'>::</span><span class='fu'>AutoCatBoostCARMA</span><span class='op'>(</span>

    <span class='co'># data args</span>
    data <span class='op'>=</span> <span class='va'>data_new</span>,
    TimeWeights <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>TimeWeights</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'None'</span><span class='op'>)</span> <span class='cn'>NULL</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>TimeWeights</span><span class='op'>]</span><span class='op'>)</span>,
    TargetColumnName <span class='op'>=</span> <span class='st'>'Weekly_Sales'</span>,
    DateColumnName <span class='op'>=</span> <span class='st'>'Date'</span>,
    HierarchGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
    GroupVariables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span>,
    TimeUnit <span class='op'>=</span> <span class='st'>'weeks'</span>,
    TimeGroups <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'weeks'</span><span class='op'>)</span> <span class='st'>'weeks'</span> <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'months'</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'weeks'</span>,<span class='st'>'months'</span><span class='op'>)</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'weeks'</span>,<span class='st'>'months'</span>,<span class='st'>'quarters'</span><span class='op'>)</span>,

    <span class='co'># Production args</span>
    TrainOnFull <span class='op'>=</span> <span class='cn'>TRUE</span>,
    SplitRatios <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>HoldoutTrain</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>N2</span>, <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>HoldoutTrain</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>N2</span><span class='op'>)</span>,
    PartitionType <span class='op'>=</span> <span class='st'>'random'</span>,
    FC_Periods <span class='op'>=</span> <span class='va'>N2</span><span class='op'>-</span><span class='va'>N1</span>,
    TaskType <span class='op'>=</span> <span class='va'>TaskType</span>,
    NumGPU <span class='op'>=</span> <span class='fl'>1</span>,
    Timer <span class='op'>=</span> <span class='cn'>TRUE</span>,
    DebugMode <span class='op'>=</span> <span class='cn'>TRUE</span>,

    <span class='co'># Target variable transformations</span>
    TargetTransformation <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>TargetTransformation</span><span class='op'>]</span><span class='op'>)</span>,
    Methods <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'YeoJohnson'</span>, <span class='st'>'BoxCox'</span>, <span class='st'>'Asinh'</span>, <span class='st'>'Log'</span>, <span class='st'>'LogPlus1'</span>, <span class='st'>'Sqrt'</span>, <span class='st'>'Asin'</span>, <span class='st'>'Logit'</span><span class='op'>)</span>,
    Difference <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>Difference</span><span class='op'>]</span><span class='op'>)</span>,
    NonNegativePred <span class='op'>=</span> <span class='cn'>TRUE</span>,
    RoundPreds <span class='op'>=</span> <span class='cn'>FALSE</span>,

    <span class='co'># Calendar-related features</span>
    CalendarVariables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'week'</span>,<span class='st'>'wom'</span>,<span class='st'>'month'</span>,<span class='st'>'quarter'</span><span class='op'>)</span>,
    HolidayVariable <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'USPublicHolidays'</span><span class='op'>)</span>,
    HolidayLookback <span class='op'>=</span> <span class='cn'>NULL</span>,
    HolidayLags <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>,
    HolidayMovingAverages <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span>,

    <span class='co'># Lags, moving averages, and other rolling stats</span>
    Lags <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'weeks'</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span> <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'months'</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>'weeks'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span>, <span class='st'>'months'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>'weeks'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span>, <span class='st'>'months'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>12</span><span class='op'>)</span>, <span class='st'>'quarters'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>,
    MA_Periods <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'weeks'</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span> <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>MaxTimeGroups</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'months'</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>'weeks'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span>, <span class='st'>'months'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>'weeks'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>51</span>,<span class='fl'>52</span>,<span class='fl'>53</span><span class='op'>)</span>, <span class='st'>'months'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>12</span><span class='op'>)</span>, <span class='st'>'quarters'</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>,
    SD_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
    Skew_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
    Kurt_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
    Quantile_Periods <span class='op'>=</span> <span class='cn'>NULL</span>,
    Quantiles_Selected <span class='op'>=</span> <span class='cn'>NULL</span>,

    <span class='co'># Bonus features</span>
    AnomalyDetection <span class='op'>=</span> <span class='cn'>NULL</span>,
    XREGS <span class='op'>=</span> <span class='va'>xregs_new</span>,
    FourierTerms <span class='op'>=</span> <span class='fl'>0</span>,
    TimeTrendVariable <span class='op'>=</span> <span class='cn'>TRUE</span>,
    ZeroPadSeries <span class='op'>=</span> <span class='cn'>NULL</span>,
    DataTruncate <span class='op'>=</span> <span class='cn'>FALSE</span>,

    <span class='co'># ML grid tuning args</span>
    GridTune <span class='op'>=</span> <span class='cn'>FALSE</span>,
    PassInGrid <span class='op'>=</span> <span class='cn'>NULL</span>,
    ModelCount <span class='op'>=</span> <span class='fl'>5</span>,
    MaxRunsWithoutNewWinner <span class='op'>=</span> <span class='fl'>50</span>,
    MaxRunMinutes <span class='op'>=</span> <span class='fl'>60</span><span class='op'>*</span><span class='fl'>60</span>,

    <span class='co'># ML evaluation output</span>
    PDFOutputPath <span class='op'>=</span> <span class='cn'>NULL</span>,
    SaveDataPath <span class='op'>=</span> <span class='cn'>NULL</span>,
    NumOfParDepPlots <span class='op'>=</span> <span class='fl'>0L</span>,

    <span class='co'># ML loss functions</span>
    EvalMetric <span class='op'>=</span> <span class='st'>'RMSE'</span>,
    EvalMetricValue <span class='op'>=</span> <span class='fl'>1</span>,
    LossFunction <span class='op'>=</span> <span class='st'>'RMSE'</span>,
    LossFunctionValue <span class='op'>=</span> <span class='fl'>1</span>,

    <span class='co'># ML tuning args</span>
    NTrees <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>NTrees</span><span class='op'>]</span>,
    Depth <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>Depth</span><span class='op'>]</span>,
    L2_Leaf_Reg <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>L2_Leaf_Reg</span><span class='op'>]</span>,
    LearningRate <span class='op'>=</span> <span class='fl'>0.03</span>,
    Langevin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/logical.html'>as.logical</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>Langevin</span><span class='op'>]</span><span class='op'>)</span>,
    DiffusionTemperature <span class='op'>=</span> <span class='fl'>10000</span>,
    RandomStrength <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>RandomStrength</span><span class='op'>]</span>,
    BorderCount <span class='op'>=</span> <span class='fl'>254</span>,
    RSM <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>RSM</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>'NULL'</span><span class='op'>)</span> <span class='cn'>NULL</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>RSM</span><span class='op'>]</span><span class='op'>)</span>,
    GrowPolicy <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>GrowPolicy</span><span class='op'>]</span>,
    BootStrapType <span class='op'>=</span> <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span>, <span class='va'>BootStrapType</span><span class='op'>]</span>,
    ModelSizeReg <span class='op'>=</span> <span class='fl'>0.5</span>,
    FeatureBorderType <span class='op'>=</span> <span class='st'>'GreedyLogSum'</span>,
    SamplingUnit <span class='op'>=</span> <span class='st'>'Group'</span>,
    SubSample <span class='op'>=</span> <span class='cn'>NULL</span>,
    ScoreFunction <span class='op'>=</span> <span class='st'>'Cosine'</span>,
    MinDataInLeaf <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

  <span class='co'># Timer End</span>
  <span class='va'>EndTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>

  <span class='co'># Prepare data for evaluation</span>
  <span class='va'>Results</span> <span class='op'>&lt;-</span> <span class='va'>CatBoostResults</span><span class='op'>$</span><span class='va'>Forecast</span>
  <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setattr.html'>setnames</a></span><span class='op'>(</span><span class='va'>Results</span>, <span class='st'>'Weekly_Sales'</span>, <span class='st'>'bla'</span><span class='op'>)</span>
  <span class='va'>Results</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>Results</span>, <span class='va'>data</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span>,<span class='st'>'Date'</span><span class='op'>)</span>, all <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>Results</span> <span class='op'>&lt;-</span> <span class='va'>Results</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>bla</span><span class='op'>)</span><span class='op'>]</span><span class='op'>[</span>, <span class='va'>bla</span> <span class='op'>:=</span> <span class='cn'>NULL</span><span class='op'>]</span>

  <span class='co'># Create totals and subtotals</span>
  <span class='va'>Results</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/groupingsets.html'>groupingsets</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>Results</span>,
    j <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Predictions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Predictions</span><span class='op'>)</span>, Weekly_Sales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Weekly_Sales</span><span class='op'>)</span><span class='op'>)</span>,
    by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>, <span class='st'>'Store'</span>, <span class='st'>'Dept'</span><span class='op'>)</span>,
    sets <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>, <span class='st'>'Store'</span>, <span class='st'>'Dept'</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>, <span class='st'>'Dept'</span><span class='op'>)</span>, <span class='st'>'Store'</span>, <span class='st'>'Dept'</span>, <span class='st'>'Date'</span><span class='op'>)</span><span class='op'>)</span>

  <span class='co'># Fill NAs with 'Total' for totals and subtotals</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>cols</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>Results</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>eval</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span> <span class='op'>:=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fifelse.html'>fifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>'Total'</span>, <span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>

  <span class='co'># Add error measures</span>
  <span class='va'>Results</span><span class='op'>[</span>, <span class='va'>Weekly_MAE</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>Weekly_Sales</span> <span class='op'>-</span> <span class='va'>Predictions</span><span class='op'>)</span><span class='op'>]</span>
  <span class='va'>Results</span><span class='op'>[</span>, <span class='va'>Weekly_MAPE</span> <span class='op'>:=</span> <span class='va'>Weekly_MAE</span> <span class='op'>/</span> <span class='va'>Weekly_Sales</span><span class='op'>]</span>

  <span class='co'># Weekly results</span>
  <span class='va'>Weekly_MAPE</span> <span class='op'>&lt;-</span> <span class='va'>Results</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Weekly_MAPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Weekly_MAPE</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>Store</span>,<span class='va'>Dept</span><span class='op'>)</span><span class='op'>]</span>

  <span class='co'># Monthly results</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/copy.html'>copy</a></span><span class='op'>(</span><span class='va'>Results</span><span class='op'>)</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>[</span>, <span class='va'>Date</span> <span class='op'>:=</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='https://lubridate.tidyverse.org/reference/round_date.html'>floor_date</a></span><span class='op'>(</span><span class='va'>Date</span>, unit <span class='op'>=</span> <span class='st'>'months'</span><span class='op'>)</span><span class='op'>]</span>
  <span class='va'>temp</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>.SD</span>, <span class='va'>sum</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>,<span class='st'>'Store'</span>,<span class='st'>'Dept'</span><span class='op'>)</span>, .SDcols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Predictions'</span>, <span class='st'>'Weekly_Sales'</span><span class='op'>)</span><span class='op'>]</span>
  <span class='va'>temp</span><span class='op'>[</span>, <span class='va'>Monthly_MAE</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>Weekly_Sales</span> <span class='op'>-</span> <span class='va'>Predictions</span><span class='op'>)</span><span class='op'>]</span>
  <span class='va'>temp</span><span class='op'>[</span>, <span class='va'>Monthly_MAPE</span> <span class='op'>:=</span> <span class='va'>Monthly_MAE</span> <span class='op'>/</span> <span class='va'>Weekly_Sales</span><span class='op'>]</span>
  <span class='va'>Monthly_MAPE</span> <span class='op'>&lt;-</span> <span class='va'>temp</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Monthly_MAPE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Monthly_MAPE</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>Store</span>,<span class='va'>Dept</span><span class='op'>)</span><span class='op'>]</span>

  <span class='co'># Collect metrics for Total (feel free to switch to something else or no filter at all)</span>
  <span class='va'>Metrics</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>
    RunNumber <span class='op'>=</span> <span class='va'>Run</span>,
    Total_Weekly_MAPE <span class='op'>=</span> <span class='va'>Weekly_MAPE</span><span class='op'>[</span><span class='va'>Store</span> <span class='op'>==</span> <span class='st'>'Total'</span> <span class='op'>&amp;</span> <span class='va'>Dept</span> <span class='op'>==</span> <span class='st'>'Total'</span>, <span class='va'>Weekly_MAPE</span><span class='op'>]</span>,
    Total_Monthly_MAPE <span class='op'>=</span> <span class='va'>Monthly_MAPE</span><span class='op'>[</span><span class='va'>Store</span> <span class='op'>==</span> <span class='st'>'Total'</span> <span class='op'>&amp;</span> <span class='va'>Dept</span> <span class='op'>==</span> <span class='st'>'Total'</span>, <span class='va'>Monthly_MAPE</span><span class='op'>]</span>,
    <span class='va'>Tuning</span><span class='op'>[</span><span class='va'>Run</span><span class='op'>]</span>,
    RunTime <span class='op'>=</span> <span class='va'>EndTime</span> <span class='op'>-</span> <span class='va'>StartTime</span><span class='op'>)</span>

  <span class='co'># Append to file (not overwrite)</span>
  <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/fwrite.html'>fwrite</a></span><span class='op'>(</span><span class='va'>Metrics</span>, file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>Path</span>, <span class='st'>'Walmart_CARMA_Metrics.csv'</span><span class='op'>)</span>, append <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='co'># Remove objects (clear space before new runs)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>CatBoostResults</span>, <span class='va'>Results</span>, <span class='va'>temp</span>, <span class='va'>Weekly_MAE</span>, <span class='va'>Weekly_MAPE</span>, <span class='va'>Monthly_MAE</span>, <span class='va'>Monthly_MAPE</span><span class='op'>)</span>

  <span class='co'># Garbage collection because of GPU</span>
  <span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Adrian Antico.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


